# タスク一覧: Next.js + Mastra Chat LLM テンプレート開発

## 🔍 重要: 品質ゲート要件

**すべてのタスクは以下の品質ゲートをクリアする必要があります:**

- ✅ **テスト実装**: 実装した機能のテストコードを含める（80%以上のカバレッジ）
- ✅ **`pnpm test`**: 全テストがパスすること
- ✅ **`pnpm lint`**: リント違反が0件であること
- ✅ **`pnpm type-check`**: TypeScript型チェックがパスすること
- ✅ **`pnpm build`**: プロダクションビルドが成功すること

📖 **詳細ガイド**: [品質ゲート・テスト実装ガイドライン](./docs/development/quality-gates.md)

---

## Phase 1: 基盤構築（1-2週間）

### 1.1 MCP サーバー統合設定

**事前条件:**

- Node.js 18+ がインストール済み
- pnpm がインストール済み
- 基本的な MCP の概念理解

**タスク内容:**

1. MCP Filesystem server の設定とテスト
2. MCP Fetch server の設定とテスト
3. MCP サーバーとの通信ライブラリ実装

**完了条件:**

- [ ] `src/lib/mcp/filesystem.ts` が実装され、ファイル読み書きが動作する
- [ ] `src/lib/mcp/fetch.ts` が実装され、Web コンテンツ取得が動作する
- [ ] MCP サーバーの接続テストが通る
- [ ] 各 MCP 機能の使用例が `examples/` に含まれる
- [ ] **品質ゲート**: MCP関連機能のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 3-4日

---

### 1.2 環境変数設定とCloudflareサービス連携

**事前条件:**

- Cloudflare アカウントが作成済み
- Cloudflare D1、R2、KV、Analytics Engine が有効化済み
- 各種サービスアカウント（Clerk、OpenAI、Brevo、Sentry、Grafana Cloud）が作成済み

**タスク内容:**

1. `.env.local.example` ファイルの作成（Cloudflare用設定含む）
2. 環境変数バリデーション機能の実装
3. Cloudflare wrangler.toml 設定
4. 各サービスのAPIキー設定手順ドキュメント作成

**完了条件:**

- [ ] `.env.local.example` に全必要環境変数が定義されている（Cloudflare設定含む）
- [ ] `wrangler.toml` にD1、R2、KV、Analytics Engine設定が記載されている
- [ ] `src/lib/env.ts` で環境変数バリデーションが実装されている
- [ ] 不正な環境変数時に適切なエラーメッセージが表示される
- [ ] `docs/setup-cloudflare.md` にCloudflare設定手順が記載されている
- [ ] **品質ゲート**: 環境変数バリデーションのテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 2日

---

### 1.3 データベーススキーマ設計と初期セットアップ

**事前条件:**

- Cloudflare D1 データベースが作成済み
- Prisma の基本的な使用法理解

**タスク内容:**

1. Prisma スキーマファイルの作成
2. マイグレーションファイルの生成
3. シードデータの作成
4. Document・Embedding管理テーブルの追加

**完了条件:**

- [ ] `prisma/schema.prisma` に User、Conversation、Message モデルが定義されている
- [ ] `prisma/schema.prisma` に Document、Embedding モデルが定義されている
- [ ] `prisma/migrations/` にマイグレーションファイルが生成されている
- [ ] `prisma/seed.ts` にサンプルデータが定義されている
- [ ] `pnpm db:migrate` でマイグレーションが実行できる
- [ ] `pnpm db:seed` でシードデータが投入できる
- [ ] **品質ゲート**: データベース操作のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 2-3日

---

### 1.4 Clerk 認証基盤セットアップ（Google Provider）

**事前条件:**

- Clerk アカウントと Application が作成済み
- Google OAuth アプリケーションが作成済み
- Clerk API キーが取得済み

**タスク内容:**

1. Clerk Google Provider 設定
2. Clerk ミドルウェアの設定
3. 認証ページ（サインイン・サインアップ）の作成
4. ユーザープロファイルページの作成
5. 認証ガードの実装

**完了条件:**

- [ ] Clerk ダッシュボードでGoogle Providerが設定されている
- [ ] `middleware.ts` でルート保護が実装されている
- [ ] `app/(auth)/sign-in/page.tsx` が実装されている
- [ ] `app/(auth)/sign-up/page.tsx` が実装されている
- [ ] `app/(dashboard)/profile/page.tsx` が実装されている
- [ ] Googleアカウントでのログインが正常に動作する
- [ ] 未認証時のリダイレクトが正常に動作する
- [ ] ユーザー情報がデータベースと同期される
- [ ] **品質ゲート**: Clerk認証機能のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 3-4日

---

## Phase 2: コア機能実装（2-3週間）

### 2.1 基本チャットUI実装

**事前条件:**

- Phase 1 の認証機能が完了している
- Tailwind CSS の設定が完了している

**タスク内容:**

1. チャットメッセージコンポーネントの作成
2. メッセージ入力フォームの作成
3. 会話履歴サイドバーの作成
4. レスポンシブデザインの実装

**完了条件:**

- [ ] `src/components/chat/MessageList.tsx` が実装されている
- [ ] `src/components/chat/MessageInput.tsx` が実装されている
- [ ] `src/components/chat/ConversationSidebar.tsx` が実装されている
- [ ] モバイル・デスクトップ両方で正常に表示される
- [ ] メッセージの送受信UIが動作する（API連携前）
- [ ] **品質ゲート**: チャットUIコンポーネントのテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 4-5日

---

### 2.2 Mastra LLM統合とストリーミング実装

**事前条件:**

- OpenAI API キーが設定済み
- Mastra の基本設定が完了している

**タスク内容:**

1. Mastra 設定ファイルの作成
2. OpenAI API 連携の実装
3. ストリーミングレスポンス機能の実装
4. プロンプトテンプレート管理

**完了条件:**

- [ ] `src/lib/mastra.ts` が実装されている
- [ ] `/api/v1/chat` エンドポイントが実装されている
- [ ] ストリーミングレスポンスが正常に動作する
- [ ] プロンプトテンプレートが設定可能
- [ ] エラーハンドリングが適切に実装されている
- [ ] **品質ゲート**: Mastra LLM統合のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 5-6日

---

### 2.3 Pinecone Vector Search 統合

**事前条件:**

- Pinecone アカウントとAPIキーが取得済み
- OpenAI API キーが設定済み（Embeddings用）

**タスク内容:**

1. Pinecone クライアントライブラリの実装
2. OpenAI Embeddings 生成機能の実装
3. ドキュメント埋め込み・保存機能の実装
4. セマンティック検索機能の実装
5. メタデータ管理機能の実装

**完了条件:**

- [ ] `src/lib/pinecone.ts` が実装されている
- [ ] `src/lib/embeddings.ts` が実装されている
- [ ] `/api/v1/embeddings/create` エンドポイントが実装されている
- [ ] `/api/v1/search/semantic` エンドポイントが実装されている
- [ ] ドキュメントのベクトル化・保存が動作する
- [ ] セマンティック検索が動作する
- [ ] メタデータによるフィルタリングが動作する
- [ ] **品質ゲート**: Pinecone Vector Search統合のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 4-5日

---

### 2.4 RAG チャット機能実装

**事前条件:**

- Pinecone vector search が実装済み
- 基本的なチャット機能が実装済み

**タスク内容:**

1. RAG パイプライン実装
2. 関連文書検索機能の実装
3. コンテキスト注入機能の実装
4. RAG対応チャットUIの実装

**完了条件:**

- [ ] `src/lib/rag.ts` が実装されている
- [ ] `/api/v1/chat/rag` エンドポイントが実装されている
- [ ] 関連文書検索が動作する
- [ ] 検索結果をコンテキストとして注入できる
- [ ] RAG モード切り替えUI が実装されている
- [ ] 引用元ドキュメント表示が動作する
- [ ] **品質ゲート**: RAGチャット機能のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 3-4日

---

### 2.5 会話履歴管理機能

**事前条件:**

- データベーススキーマが作成済み
- 基本的なチャット機能が実装済み

**タスク内容:**

1. 会話CRUD操作の実装
2. メッセージ保存機能の実装
3. 会話一覧表示機能の実装
4. 会話削除機能の実装
5. セマンティック検索による会話検索

**完了条件:**

- [ ] `/api/v1/conversations` CRUD エンドポイントが実装されている
- [ ] 新規会話作成が動作する
- [ ] 会話履歴の表示が動作する
- [ ] 会話の削除が動作する
- [ ] メッセージが正しくデータベースに保存される
- [ ] 会話のセマンティック検索が動作する
- [ ] **品質ゲート**: 会話履歴管理機能のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 3-4日

---

### 2.6 Cloudflare R2 ファイルストレージ統合

**事前条件:**

- Cloudflare R2 バケットが作成済み
- wrangler.toml にR2設定が記載済み

**タスク内容:**

1. R2 クライアントライブラリの実装
2. ファイルアップロード機能の実装
3. ファイル取得・削除機能の実装
4. チャット添付ファイル機能の実装
5. ドキュメント自動ベクトル化機能の実装

**完了条件:**

- [ ] `src/lib/cloudflare/r2.ts` が実装されている
- [ ] `/api/v1/files/upload` エンドポイントが実装されている
- [ ] `/api/v1/files/[id]` 取得・削除エンドポイントが実装されている
- [ ] チャットでファイル添付が動作する
- [ ] ファイルタイプ・サイズ制限が実装されている
- [ ] アップロード時に自動でベクトル化される
- [ ] **品質ゲート**: Cloudflare R2ファイルストレージ統合のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 中
**見積もり時間:** 4-5日

---

### 2.7 Cloudflare KV キャッシュ統合

**事前条件:**

- Cloudflare KV namespace が作成済み
- wrangler.toml にKV設定が記載済み

**タスク内容:**

1. KV クライアントライブラリの実装
2. ユーザー設定キャッシュ機能の実装
3. セッション情報キャッシュの実装
4. キャッシュ無効化戦略の実装

**完了条件:**

- [ ] `src/lib/cloudflare/kv.ts` が実装されている
- [ ] ユーザー設定がKVにキャッシュされる
- [ ] セッション情報の高速アクセスが実現されている
- [ ] 適切なTTL設定がされている
- [ ] キャッシュ無効化が正常に動作する
- [ ] **品質ゲート**: Cloudflare KVキャッシュ統合のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 低
**見積もり時間:** 2-3日

---

### 2.8 リアルタイム状態同期

**事前条件:**

- TanStack Query の基本設定が完了している
- 基本的なAPI エンドポイントが実装済み

**タスク内容:**

1. TanStack Query の設定とプロバイダー作成
2. リアルタイムデータ同期の実装
3. 楽観的更新の実装
4. エラー状態の管理

**完了条件:**

- [ ] `src/lib/query-client.ts` が実装されている
- [ ] 会話データのキャッシュ・同期が動作する
- [ ] 楽観的更新でUXが向上している
- [ ] ネットワークエラー時の適切な処理がされる
- [ ] **品質ゲート**: リアルタイム状態同期のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 中
**見積もり時間:** 3日

---

## Phase 3: 状態管理・最適化（1-2週間）

### 3.1 Zustand チャット状態管理

**事前条件:**

- 基本的なチャット機能が実装済み
- Zustand の基本概念理解

**タスク内容:**

1. チャット状態ストアの作成
2. UI状態ストアの作成
3. 状態の永続化設定
4. TypeScript型定義の強化

**完了条件:**

- [ ] `src/stores/chat.ts` が実装されている
- [ ] `src/stores/ui.ts` が実装されている
- [ ] ブラウザリロード時に状態が復元される
- [ ] 全ての状態に適切な型定義がされている
- [ ] **品質ゲート**: Zustandチャット状態管理のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 中
**見積もり時間:** 2-3日

---

### 3.2 Zod バリデーション統合

**事前条件:**

- API エンドポイントが基本実装済み
- Zod の基本的な使用法理解

**タスク内容:**

1. API入力バリデーションスキーマの作成
2. フォームバリデーションの実装
3. エラーメッセージの国際化対応
4. 型安全なAPI通信の実装

**完了条件:**

- [ ] `src/lib/validations/` にスキーマが定義されている
- [ ] 全てのAPI エンドポイントでバリデーションが動作する
- [ ] フォーム入力時のリアルタイムバリデーションが動作する
- [ ] バリデーションエラーが適切に表示される
- [ ] **品質ゲート**: Zodバリデーション統合のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 中
**見積もり時間:** 2-3日

---

### 3.3 パフォーマンス最適化

**事前条件:**

- 基本機能が全て実装済み
- Next.js のパフォーマンス最適化手法理解

**タスク内容:**

1. React.memo、useMemo の適用
2. 画像最適化の実装
3. コード分割の実装
4. バンドルサイズ最適化

**完了条件:**

- [ ] 不要な再レンダリングが削減されている
- [ ] 画像が適切に最適化されている
- [ ] 初期バンドルサイズが2MB以下
- [ ] Core Web Vitals スコアが良好
- [ ] **品質ゲート**: パフォーマンス最適化のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 低
**見積もり時間:** 2-3日

---

## Phase 4: 監視・通知機能（1週間）

### 4.1 Sentry エラー監視設定

**事前条件:**

- Sentry アカウントとプロジェクトが作成済み
- Sentry DSN が取得済み

**タスク内容:**

1. Sentry Next.js 統合の設定
2. エラー境界コンポーネントの実装
3. カスタムエラー報告の実装
4. パフォーマンス監視の設定

**完了条件:**

- [ ] `sentry.client.config.ts` が実装されている
- [ ] `sentry.server.config.ts` が実装されている
- [ ] エラー境界でエラーがキャッチされる
- [ ] Sentry ダッシュボードでエラーが確認できる
- [ ] パフォーマンスメトリクスが収集されている
- [ ] **品質ゲート**: Sentryエラー監視のテストコードが実装されている
- [ ] **品質ゲート**: `pnpm test` が全てパスする
- [ ] **品質ゲート**: `pnpm lint` が全てパスする
- [ ] **品質ゲート**: `pnpm type-check` が全てパスする
- [ ] **品質ゲート**: `pnpm build` が全てパスする

**優先度:** 高
**見積もり時間:** 2日

---

### 4.2 OpenTelemetry 可観測性（Analytics Engine + Grafana Cloud）

**事前条件:**

- OpenTelemetry の基本概念理解
- Cloudflare Analytics Engine が有効化済み
- Grafana Cloud アカウントが作成済み

**タスク内容:**

1. OpenTelemetry の初期設定
2. Cloudflare Analytics Engine へのメトリクス送信
3. Grafana Cloud へのトレーシング・ログ送信
4. ダッシュボードの作成

**完了条件:**

- [ ] `src/lib/telemetry.ts` が実装されている
- [ ] Cloudflare Analytics Engine にメトリクスが送信される
- [ ] Grafana Cloud にトレースとログが送信される
- [ ] API リクエストのトレーシングが動作する
- [ ] Grafana ダッシュボードでメトリクスが可視化される
- [ ] アラート設定が実装されている

**優先度:** 中
**見積もり時間:** 2-3日

---

### 4.3 Brevo メール機能統合

**事前条件:**

- Brevo アカウントとAPI キーが取得済み
- メールテンプレートの基本理解

**タスク内容:**

1. Brevo API クライアントの実装
2. ウェルカムメール機能の実装
3. 使用量通知メールの実装
4. メールテンプレートの作成

**完了条件:**

- [ ] `src/lib/email.ts` が実装されている
- [ ] 新規登録時にウェルカムメールが送信される
- [ ] 使用量閾値超過時にアラートメールが送信される
- [ ] メール送信の使用例が `examples/` にある

**優先度:** 中
**見積もり時間:** 2-3日

---

### 4.4 Pino 構造化ログ

**事前条件:**

- Pino の基本的な使用法理解
- ログレベルの概念理解

**タスク内容:**

1. Pino ロガーの設定
2. 構造化ログの実装
3. ログローテーション設定
4. 本番環境用ログ設定

**完了条件:**

- [ ] `src/lib/logger.ts` が実装されている
- [ ] JSON形式の構造化ログが出力される
- [ ] 適切なログレベルが設定されている
- [ ] 機密情報がログに含まれない

**優先度:** 中
**見積もり時間:** 1-2日

---

## Phase 5: セキュリティ・最終調整（1週間）

### 5.1 セキュリティ強化

**事前条件:**

- 基本機能が全て実装済み
- セキュリティベストプラクティスの理解

**タスク内容:**

1. CSRF 保護の実装
2. XSS 保護の強化
3. セキュリティヘッダーの設定
4. レート制限の実装

**完了条件:**

- [ ] CSRF トークンが適切に実装されている
- [ ] 入力サニタイゼーションが実装されている
- [ ] セキュリティヘッダーが設定されている
- [ ] API レート制限が動作する

**優先度:** 高
**見積もり時間:** 2-3日

---

### 5.2 包括的テスト実装

**事前条件:**

- 全機能が実装済み
- テストフレームワーク（Vitest）の理解

**タスク内容:**

1. ユニットテストの作成
2. 統合テストの作成
3. E2Eテストの作成
4. テストカバレッジの確認

**完了条件:**

- [ ] 重要な関数のユニットテストが実装されている
- [ ] API エンドポイントの統合テストが実装されている
- [ ] 主要フローのE2Eテストが実装されている
- [ ] テストカバレッジが80%以上

**優先度:** 中
**見積もり時間:** 3-4日

---

### 5.3 ドキュメント整備

**事前条件:**

- 全機能が実装済み
- 各ライブラリの使用例が準備済み

**タスク内容:**

1. README.md の完成
2. API ドキュメントの作成
3. 環境設定ガイドの作成
4. 各ライブラリ使用例の整備

**完了条件:**

- [ ] `README.md` にセットアップ手順が記載されている
- [ ] `docs/api.md` にAPI仕様が記載されている
- [ ] `docs/setup.md` に詳細設定手順が記載されている
- [ ] `examples/` に各ライブラリの実用例がある

**優先度:** 高
**見積もり時間:** 2-3日

---

### 5.4 Cloudflare Pages デプロイ設定

**事前条件:**

- 全ての機能が実装済み
- Cloudflare Pages プロジェクトが作成済み
- GitHub リポジトリが連携済み

**タスク内容:**

1. Cloudflare Pages 用ビルド設定
2. Next.js @cloudflare/next-on-pages 設定
3. プレビューブランチ設定
4. 環境変数の本番設定

**完了条件:**

- [ ] `next.config.ts` に Cloudflare 用設定が追加されている
- [ ] `@cloudflare/next-on-pages` が正常に動作する
- [ ] GitHub プッシュ時に自動デプロイされる
- [ ] プレビューブランチが正常に動作する
- [ ] 本番環境で全機能が動作する

**優先度:** 高
**見積もり時間:** 2-3日

---

### 5.5 最終品質チェック

**事前条件:**

- 全ての機能とドキュメントが完成している
- Cloudflare へのデプロイが完了している
- lefthook による品質チェックが設定済み

**タスク内容:**

1. 全機能の動作確認（ローカル・本番）
2. セキュリティ監査
3. パフォーマンステスト
4. ドキュメント検証

**完了条件:**

- [ ] ローカル・本番両環境で全機能が期待通りに動作する
- [ ] セキュリティ脆弱性が検出されない
- [ ] パフォーマンス要件を満たしている
- [ ] ドキュメント通りにセットアップできる
- [ ] Cloudflare Pages でのデプロイが成功する

**優先度:** 高
**見積もり時間:** 2日

---

## 全体進捗管理

### マイルストーン

- **Week 2 End**: Phase 1 完了（MCP、Cloudflare基盤、認証）
- **Week 4 End**: Phase 2 完了（チャット機能、R2/KV統合）
- **Week 5 End**: Phase 3 完了（状態管理・最適化）
- **Week 6 End**: Phase 4 完了（監視・通知）
- **Week 7 End**: Phase 5 完了（セキュリティ・デプロイ・リリース）

### リスク管理

- **高リスク**: MCP サーバー統合の技術的難易度
- **中リスク**: Cloudflare Pages/Functions の制約・互換性問題
- **中リスク**: 外部API（OpenAI、Brevo）の仕様変更
- **低リスク**: パフォーマンス要件の未達成

### 品質ゲート

各フェーズ完了時に以下をチェック:

- [ ] 全ての完了条件が満たされている
- [ ] lefthook による品質チェックが通る
- [ ] ドキュメントが更新されている
- [ ] セキュリティチェックが通る
